%
% TeX模板
%
% 中文支持方案: XeTeX + xeCJK
% author: Tony Bai
%

%
% preamble begin {
%

\documentclass[a4paper,11pt,titlepage]{book}                % 五号字

\XeTeXinputencoding "GBK"                                   % 本文件采用GBK编码

\XeTeXlinebreaklocale "zh"
\XeTeXlinebreakskip = 0pt plus 1pt minus 0.1pt

\usepackage{fontspec}
\usepackage{xunicode} 

\usepackage{titletoc}                                       % 控制目录
\usepackage{appendix}                                       % 控制附录

\usepackage[colorlinks,
            linkcolor=black,
            citecolor=black]{hyperref}                      % \url

% 页边距设置
\usepackage[top=1.2in,bottom=1.2in,left=1.2in,right=1in]{geometry}

% 封面设置
\usepackage{xltxtra}                                        % xltxtra include the cmd \XeTeX
\title{Haskell程序设计}
\author{著：Graham Hutton\\
        译：Tony Bai\footnote{\url{http://bigwhite.blogbus.com}}}
\date{October, 2010}

% 页眉页脚设置
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}                                                  % 清空页眉页脚
\fancyhead[LE,RO]{\thepage}                                 % 偶数页左,奇数页右
\fancyhead[RE]{\leftmark}                                   % 偶数页右
\fancyhead[LO]{\rightmark}                                  % 奇数页左
\fancypagestyle{plain}{
\fancyhf{}                                                  % 重定义plain页面样式
\renewcommand{\headrulewidth}{0pt}
}

\renewcommand\chaptermark[1]{\markboth{\chaptername~ #1}{}}
\renewcommand\sectionmark[1]{\markright{\thesection~ #1}}

% 行距
\renewcommand{\baselinestretch}{1.25}

% 章节设置
\usepackage{titlesec} 
\titleformat{\chapter}{\centering\huge}{第\thechapter{}章}{1em}{\textbf}

% xeCJK设置
\usepackage[slantfont, boldfont, CJKaddspaces]{xeCJK}
\setmainfont{Times New Roman}                                % view the font list through the cmd "fc-list :lang=en"
\setCJKmainfont{SimSun}                                      % view the font list through the cmd "fc-list :lang=zh"
\setCJKfamilyfont{song}{SimSun}
\setsansfont{AR PL UKai CN}


% 重定义设置
\renewcommand{\chaptername}{第{\thechapter}章}
\renewcommand{\contentsname}{目~录}
\renewcommand{\indexname}{索引}
\renewcommand{\listfigurename}{插图目录}
\renewcommand{\listtablename}{表格目录}
\renewcommand{\figurename}{图}
\renewcommand{\tablename}{表}
\renewcommand{\appendixname}{附录}
\renewcommand{\appendixpagename}{附录}
\renewcommand{\appendixtocname}{附录}
%\renewcommand\refname{参考文献}

\usepackage{amsmath}

%
% } preamble end
%


%
% body begin {
%

\begin{document}

\maketitle                                                  % 生成title

\chapter*{序}
\addcontentsline{toc}{chapter}{序}
\begin{quotation}
...这个世界上有两种设计软件的方法：一种是使设计尽量的简化，以至于明显没有任何缺陷；而另一种是使设计尽量的复杂，以至于找不到明显的缺陷。第一种方法更加困难。
\begin{flushright}
\textit{ -- Tony Hoare，1980 ACM图灵奖演讲}                 % or use \itshape cmd
\end{flushright}
\end{quotation}
这本书讲述了一种以简单、清晰和优雅为关键目标的编程方法。更具体的说，本书使用Haskell语言来介绍函数式编程。

函数式编程与当前大多数编程语言比如Java，C++，C和Visual
Basic所提倡的风格相差很大。特别是当前大多数语言是与底层硬件紧密关联的，在这个意义上编程的基本思想就是修改已存储的值。与此相反，Haskell则提倡一种更为抽象的编程风格，这种风格的基本思想则是将函数应用到实际参数。正如我们将要看到的，更高的层次将让我们拥有更为简单的程序，并且支持一系列强大的解构和论证程序的新方法。

本书主要面对具备大专水平的学习计算机科学的学生，但也同样广泛适用于那些想了解和学习Haskell编程的读者。你不需要拥有任何编程经验，所有的概念都从基本原理讲起，并伴以精心挑选的例子。

本书使用的Haskell版本是Haskell 98，Haskell语言的标准版本，Haskell设计者花费了15年才最终发布了这个标准。由于这里仅仅是介绍性的文字，所以我们不会去涉及
Haskell语言以及其相关库的所有方面。本书大约一半内容是专门介绍该语言的主要特点的，而另一半则包括了Haskell编程的例子和案例研究。每个章节还包括了一系列的练习以及关于进一步阅读更高级、更专业主题的建议。

本书基于课程材料编写而成，这些课程材料在诺丁汉大学经过了多年的改进和课程测试。通过20学时的授课以及大约40小时的自学、实验室实践和编程作业，你就可以学完本书的大部分内容。然而，你还需要更多的时间详细学习一下后面的一些章节以及一些编程例子。

本书的官方网站提供了一系列辅助资料，包括每个章节的幻灯片和一些扩展例子的Haskell代码。教师还可以通过发送电邮到solutions@cambridge.org得到每个章节练习题的标准答案以及大量带有标准答案的试题集。

\begin{flushleft}
致谢\\
\end{flushleft}

诺丁汉大学编程社团为函数式编程的研究与教学提供了一个极好的环境。感谢学校提供假期让我可以进行本书的写作。感谢所有学生和讲师们关于我的Haskell课程的反馈;
感谢Thorsten Altenkirch, Neil Ghani, Mark Jones (现在在波特兰州), Conor McBrideh和Henrik Nilsson在FOP社区与我进行的关于函数式编程的想法以及如何表达这些想法的交流和讨论。

我还要感谢David Tranah和Dawn Preston在剑桥大学出版社出色的编辑工作; 感谢Mark
Jones的Haskell解释器; 感谢Ralf Hinze和Andres Loh提供的lhs2TeX排版系统;感谢Rik
van Geldrop和Jaap van der Woude关于使用本书草稿的反馈; 感谢Kees van den Broek,
Frank Heitmann和 Bill Tonkin指出的本书的错误;感谢Ian
Bayley和所有匿名评审者极富价值的评论;感谢Joel Wright提供的倒计时程序。

\begin{flushright}
Graham Hutton\\
诺丁汉, 2006
\end{flushright}

\tableofcontents                                            % 生成目录
\setcounter{tocdepth}{3}                                    % 设置目录深度

\chapter{导~言}
在这一章节中，我们为本书的后续部分设定了阶段。我们从回顾函数的概念开始，然后介绍函数式编程的概念，总结Haskell的主要特点和它的历史，最后通过两个小例子“品尝”一下Haskell的味道。

\section{函数}
在Haskell中，一个函数是一个映射，它有一个或多个参数，并产生唯一一个结果。我们可以通过一个等式来定义函数，等式中包含函数的名字、函数参数的名字以及详细描述如何依据参数计算出结果的函数体。

例如，一个名为double的函数，参数是一个数字x，产生的结果为x~+~x，可通过如下等式定义：
\[double~x = x + x \]

当一个函数被应用到实际参数时，其结果可通过将实际参数替换函数体中的参数名称的方式获得。这个过程可能会立即产生一个不能被进一步简化的结果，比如一个数字。而更为常见的情况是，这个结果是一个含有其他函数程序的表达式，它必须被以同样的方式处理才能产生最终的结果。

例如，程序double 3将函数double应用到数字3的结果可通过以下计算过程得出，每一步计算通过花括号里简短注释解释：

\[ \begin{split}
double~3\\ 
= \{applying~double\} \\
3 + 3\\
= \{applying +\}\\
6
\end{split} \]

同样，两次应用double的内嵌程序double (double 2)的结果可以通过如下计算过程得出：

\[ \begin{split}
double~(double~2)\\
= \{applying~the~inner~double\}\\
double~(2~+~2)\\
= \{applying~+~\}\\
double~4\\
= \{applying~double \}\\
4+4\\
= \{applying~+\}\\
8
\end{split} \]

另外，同样的结果也可以通过先从外层的函数double开始计算获得：

\[ \begin{split}
double~(double~2)\\
= \{applying~the~outer~double\}\\
double~2~+~double~2\\
= \{applying~the~first~double\}\\
(2~+~2)~+~double~2\\
= \{applying~the~first~+~\}\\
4~+~double~2\\
= \{applying~double\}\\
4~+~(2~+~2)\\
= \{applying~the~second~+\}\\
4+4\\
= \{applying~+~\}\\
8
\end{split} \]

但是，这个计算过程比我们原来的版本多出两步，因为表达式double 2在第一步中被复制了一份并因此被化简了两次。一般来说，函数在计算过程中应用的顺序不会影响最终的结果值，但它可能会影响到所需步骤的数量，并可能影响计算过程是否终止的判断。本书第12章针对这些问题作了更为详细的探究。

\section{函数式编程}

什么是函数式编程？见仁见智，很难给出一个确切的定义。但总的来说，函数式编程可以被看作一种编程风格，这种风格的基本计算方式是将函数应用于实际参数。相应的，一门函数式编程语言就是支持和鼓励使用函数式风格的计算机编程语言。

为了说明这些概念，让我们考虑一个计算从1到n的整数和的任务吧。在当前大多数编程语言中，这个任务通常可以通过使用两个可随时改变的存储值变量实现，一个变量从1变到n，另外一个变量用来累加总数。

例如，如果我们使用赋值符号:=来改变一个变量的值，使用关键字repeat和until来反复执行一个指令序列，直到某个条件被满足，那么下面的指令序列计算出所需的总和：


\chapter{第一步}

\end{document}

%
% } body end
%
