\XeTeXinputencoding "GBK"                                   % 本文件采用GBK编码

\chapter{第一步}

在本章中，我们迈出使用Haskell的第一步。我们首先介绍Hugs系统和Prelude标准库，然后解释函数应用的符号，开发我们的第一个Haskell脚本，最后讨论一些关于脚本的语法惯例。

\section{Hugs系统}
正如我们在前一章所看到的，我们可以手工执行一些小的Haskell程序，然而在实践中，我们通常需要一个可以自动执行程序的系统。在这本书中，我们使用一个被称为Hugs的交互式系统，它也是使用最广泛的Haskell实现。

Hugs的交互式的本质使得其非常适合教学和制作原型。并且它的性能能满足绝大多数应用的要求。然而，如果需要更高的性能或独立的可执行程序，一些Haskell的编译器也是可用的。这其中使用最广泛的是Glasgow Haskell的编译器，这个编译器也有一个交互式版本，和Hugs的运行方式类似，and can readily be used in its place for the purposes of this book。

\section{标准Prelude}

当Hugs系统启动时，它首先加载一个名为Prelude.hs的库文件，然后显示一个>提示符，表明系统正在等待用户输入要计算的表达式。例如，这个库文件定义了许多熟悉的操作整数的函数，包括五个主要的算术运算加，减，乘，除和指数运算，如下所示：
\begin{verbatim}
>2 + 3 
5
>2-3
-1
> 2* 3
6
> 7 'div' 2
3
>2 ^3
8
\end{verbatim}

注意，整数除法操作符记作'div'，如果结果是一个适当的分数，那么将向下圆整到最近的那个整数。

按正常数学惯例，指数运算比乘法和除法具有更高的优先级，进而也具有比加法和减法更高的优先级。例如，\verb|2 * 3 ^ 4|表示\verb|2 *（3 ^ 4）|，而\verb|2 + 3 * 4|表示\verb|2 +（3 * 4）|。此外，指数运算是右结合的，而其他四种算术操作符则是左结合的。例如，\verb|2 ^ 3 ^ 4|意味着\verb|2 ^ （3 ^ 4）|，而2 - 3 + 4则指的是（2 - 3）+ 4。但实际应用时，在算术表达式里显式使用括号而不是依靠上述惯例往往表达得更为清楚。 

除了操作整数的函数外，这个库文件还提供了一些有用的操作列表的函数。在Haskell中，列表中的元素用方括号括上，并以逗号分隔。最常用的一些操作列表的库函数说明如下。

\begin{itemize}
\item 从一个非空列表中选出第一个元素:
> head [1, 2, 3, 4, 5]
1

\item 从一个非空列表中删除第一个元素:
> tail [1, 2, 3, 4, 5]
[2, 3, 4, 5]

\item 选出列表中的第n个元素（从0开始计数):
> [1, 2, 3, 4, 5] !! 2
3

\item 选出列表中的前n个元素:
> take 3 [1, 2, 3, 4, 5]
[1, 2, 3]

\item 从列表中删除前n个元素:
> drop 3 [1, 2, 3, 4, 5]
[4, 5]

\item 计算列表的长度:
> length [1, 2, 3, 4, 5]
5

\item 计算数字列表中元素之和:
> sum [1, 2, 3, 4, 5]
15

\item 计算数字列表中元素之积:
> product [1, 2, 3, 4, 5]
120

\item 连接两个列表:
> [1, 2, 3] ++ [4, 5]
[1, 2, 3, 4, 5]

\item 反转列表:
> reverse [1, 2, 3, 4, 5]
[5, 4, 3, 2, 1]

\end{itemize}

针对某些参数值，标准prelude中的一些函数可能产生错误。比如试图除零或从一个空列表中选择第一个元素都会产生一个错误：
\begin{verbatim}
> 1 ‘div ‘ 0
Error
> head [ ]
Error
\end{verbatim}

实际上，当出现错误时，Hugs系统也会产生一个消息，提供一些可能原因的信息。

作为参考，附录A介绍了标准Prelude最常用的一些定义，附录B显示了特殊的Haskell符号，如\verb|^|和+的类型和使用普通键盘。

\section{函数应用}

在数学中，将函数应用到参数通常表示为用括号将参数括起来。而往往两值相乘的表示很简单，将两个值一个接着一个的挨着写即可。例如，在数学中，表达式

$f (a, b) + c d$

意为将函数f应用到两个参数a和b上，并将结果与c和d的乘积相加。在Haskell中，函数应用使用空格表示，然而两值相乘则显式使用\verb|*|操作符表示。例如，上面的表达式使用Haskell编写如下：

\verb|f a b + c * d|

此外，函数应用拥有比其它操作符更高的优先级。比如，f a + b 意为(f a) + b。下表给出了一些例子，来进一步说明函数符号在数学与Haskell之间的差异。

\begin{table}[htbp]
\label{tab:threesome}
\centering
\begin{tabular}{ll}
\hline
Mathematics & Haskell  \\
\hline
$f(x)$ & f~x \\
$f(x,y)$ & f~x~y \\
$f(g(x))$ & f~(g~x) \\
$f(x,g(y))$ & f~x~(g~y)\\
$f(x)g(y)$ & f~x~*~g~y\\
\hline
\end{tabular}
\end{table}

注意上面的表达式f~(g~x)在Haskell中依然需要括号，因为f~g~ x本身会被解释为将函数f应用到两个参数g和x。然而其本意却是将f应用到一个参数上，该参数即是将函数g应用到参数x上的结果。A
similar remark holds for the expression f~x~(g~y).

\section{Haskell脚本}
除了标准Prelude所提供的函数外，你也可以定义新的函数。你无法在Hugs的>提示符下定义新函数，只能在脚本中定义。脚本是一个由一系列定义组成的文本文件。按照惯例，Haskell脚本通常有用.hs作为文件后缀名以区别于其他种类的文件他们。

\subsection{我的第一个脚本}
当开发一个Haskell脚本时，保持两个窗口一直打开着是很有用的：一个窗口运行脚本的编辑器，另外一个运行Hugs。举个例子，假设我们启动文本编辑器输入两个函数的定义，并保存脚本到一个名为test.hs的文件中：

\begin{verbatim}
double x = x + x
quadruple x = double (double x)
\end{verbatim}
